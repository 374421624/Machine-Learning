# 标签传播

标签体系是各大公司业务系统最重要的基石，无论是user标签还是item标签，无论多模态文本标签、图片标签还是视频标签。可以这样说，评价一个公司技术能力强弱，其构建起的标签体系是最关键的评价指标。这里基于个人经验，借鉴GNetMine以及PageRank算法，阐述自己设计的基于社交图谱的标签传播算法。

标签体系最基础也是最难的两个目标，就是准和全。准即准确率，要求算法打的标签要准确，毕竟标签体系很大一部分是作为其他后续算法的输入，如果后续算法的数据源都不准确，何谈产出好效果；全即覆盖率，要求覆盖一定量数据集，如果数据集很少那人工打标即可，还特别准，然而现实业务场景应用中，数据集非常大，人工只能打标其中一部分，这就要求算法要具有一般性。这里我利用知识图谱的信息传递性，尤其社交网络中的关系传递，只用约万分之一的已标注样本量给大量待标注数据进行标签标注\(约十万已标注数据给数十亿数据打标\)，且效果准确，可用于商业推广。

## 算法概述

基于约十万已标注账号信息，一段时间内账号间社交互动\(关注、转发、评论等\)信息，输出预测未标注账号属于各类别概率，设计了基于社交网络的多轮迭代标签传播算法。分为损失设计、标签传播、结果汇集三部分解释。总流程如下：

```text
初始化: f(0)=y, Loss(0)=Inf

while Loss变小:
    标签传播: 由第t轮结果f(t)和社交互动关系R，得到第t+1轮结果f(t+1)
    结果汇集: 基于第t+1轮结果f(t+1)计算Loss(t+1)

输出Loss最小一轮结果f
```

## 算法设计

### 损失函数

损失如下公式，由精度损失和泛化损失两部分组成，其中 $$\alpha$$和 $$\beta$$ 调节更关注准确还是泛化：

                             $$\text{Loss}=\alpha\sum\limits_{i=1}^I\sigma_i|\hat{y_i}-y_i|+\beta\sum\limits_{a,b}^S\omega_{a,b}|\hat{y_a}-\hat{y_b}|\\  =\alpha \sum\limits_{i=1}^I\sigma_i|\cos(\hat{f(t)_i},y_i)|+\beta\sum\limits_{a,b}^S\omega_{a,b}|\cos(\hat{f(t)_a},\hat{f(t)_b})|$$ 

1、精度损失 $$\alpha \sum\limits_{i=1}^I\sigma_i|\cos(\hat{f(t)_i},y_i)|$$ 。集合 $$I$$ 为Ground Truth集合；参数 $$\sigma_i$$ 表示 $$i$$ 个已标注样本账号的重要程度，比如在微博场景下是此账号的粉丝数等，我们更倾向于将粉丝量大的账号类别预测准；余弦距离 $$|\cos(\hat{f(t)_i},y_i)|$$ 即第t轮账号 $$i$$ 的预测向量和其Ground Truth向量的余弦距离，向量每一列对应一个类别，比如分成语数外三类， $$\hat{f(t)_i}=(0.2,0.7,0.1)$$ ，账号 $$y_i=(0,1,0)$$ 实际属于数学类别。

2、泛化损失 $$\beta\sum\limits_{a,b}^S\omega_{a,b}|\cos(\hat{f(t)_a},\hat{f(t)_b})|$$ 。集合 $$S$$ 为相似账号的集合；参数 $$w_{a,b}$$ 表示账号 $$a$$ 和 $$b$$ 的相似程度，比如微博场景下粉丝重合度 $$w_{a,b}=\frac{A\cap B}{A\cup B}$$ ，两账号粉丝交集数/两账号粉丝并集数，我们更倾向于关注粉丝重合度高的账号对，物理意义即若两账号粉丝相同，则两账号类别大概率相似；余弦距离 $$|\cos(\hat{f(t)_a},\hat{f(t)_b})|$$ 即第t轮账号 $$a$$ 的预测向量和第t轮账号 $$b$$ 的预测向量的余弦距离。

### 标签传播

具体标签传播过程可以由下面公式表达：

                                         $$f(t+1)=\sum\limits_{r\in R} W_r*f(t)+W_y*y \\ =\sum\limits_{r\in R} (\alpha_r*P_r*Q_r)*f(t)+W_y*y$$ 

### 结果汇集



## 算法解释

