# LeNet-5

## LeNet-5简介

LeNet-5是1998年LeCun发表的用于手写字符识别的经典卷积神经网络模型。当年美国很多银行就采用了这种模型来识别支票上的手写数字，能够达到如此高的商业程度，可见其识别精准和在深度学习发展史上的重要地位。

LeNet-5在论文中被用于识别MNIST数据集提供的0~9共10个手写数字。MNIST是当时Google实验室的Corinna Cortes和纽约大学柯朗研究所的Yann LeCun共同建立的手写数字数据库，包含训练集60000张即测试集10000张手写数字图片。该数据集提供的图片尺寸统一为28\*28，图中包含字符的最大尺寸为20\*20。

## LeNet-5详解

LeNet-5网络除输入层外包含7层，每层都含有可学习的参数。如下图所示，卷积层标记为 $$C_x$$ ，下采样层标记为 $$S_x$$ ，全连接层标记为 $$F_x$$ ，其中 $$x$$ 表示层下标（这个下标是指的在网络中的顺序，不是第几个这样的层）。

![](../../../.gitbook/assets/20150903161702138.png)

**输入：**32\*32的手写字体图片，这些手写字体包含0~9数字，也就是相当于10个类别的图片。网络输入是32\*32像素的图片，这一尺寸明显大于MNIST提供的字符尺度（28\*28）。这样设计的原因是希望如笔画末端或尖端等潜在的有效特征能够出现在最高层特征检测子感受野的中心位置，换句话说，网络高层的各个特征都集成了笔画和尖角边缘信息。在LeNet-5中，最后一个卷积层（ $$C_3$$ ）的所有感受野中心会在输入的32像素\*32像素图片中形成一个20\*20的区域。此外，还需对输入像素的取值进行标准化：白色背景取值 $$-0.1$$ ，黑色前景取值 $$1.175$$ ，这样使得在MNIST数据集上像素点取值均值近似为 $$0$$ ，方差近似为 $$1$$ 。数据标准化能够有效地加速训练过程。

**输出：**分类结果，0~9之间的一个数。因此我们可以知道，这是一个多分类问题，总共有十个类，因此神经网络的最后输出层必然是SoftMax问题，然后神经元的个数是10个。

**输入层：**32\*32的图片（因为是灰度图，所以其实是32\*32\*1），也就是相当于1024个神经元。

$$C_1$$ **层：**是网络的第一个卷积层，paper这里选择6个卷积核，卷积核大小选择5\*5，这样我们可以得到6个特征图，每个特征图大小为28\*28（$$28=32-5+1$$），也就是神经元的个数为 $$6*28*28=784$$ 。所以现在我们的维度从32\*32\*1变成了28\*28\*6

![](../../../.gitbook/assets/lenet_layer1.jpg)

$$S_2$$ **层：**是下采样层，也就数使用最大池化进行下采样，池化的大小选择 $$(2,2)$$ ，也就相当于对 $$C_1$$ 层28\*28的图片，进行分块（即邻域），每个块的大小为2\*2，这样我们可以得到14\*14个块，我们统计每个块中最大的值作为下采样的新像素，因此我们可以得到14\*14大小的图片，共有6个这样的图片。至此，我们的维度从28\*28\*6变成了14\*14\*6。在最初的论文中，会将邻域里的4个值求和乘系数并加上一个偏置，所得结果再通过Sigmoid激活函数来产生 $$S_2$$ 层的特征图。这里系数和偏置便是本层需要学习的参数。在后来的实现中，常用最大池化取代上述过程。

![](../../../.gitbook/assets/lenet_layer2.jpg)

$$C_3$$ **层：**同样是卷积层，这一层卷积核大小仍未5\*5，据此我们可以得到新的图片大小为10\*10（ $$10 = 14-5+1$$ ），然后我们希望可以得到16张特征图，即我们的维度从14\*14\*6变成10\*10\*16。

![](../../../.gitbook/assets/lenet_layer3.jpg)

那么问题来了，这一层是最难理解的，我们知道 $$S_2$$ 包含：6张14\*14大小的图片，我们希望这一层得到的结果是：16张10\*10的图片。这16张图片的每一张，是通过 $$S_2$$ 的6张图片进行加权组合得到的，具体怎么组合如下面所示：

![](../../../.gitbook/assets/image%20%2815%29.png)

前6个特征图与 $$S_2$$ 层相连的3个特征图相连接，后面6个特征图与 $$S_2$$ 层相连的4个特征图相连接，后面3个特征图与 $$S_2$$ 层部分不相连的4个特征图相连接，最后一个与 $$S_2$$ 层的所有特征图相连。卷积核大小仍然为5\*5，所以共有 $$6*(3*5*5*1)+6*(4*5*5*1)+3*(4*5*5*1)+1*(6*5*5*1)=1516$$ 个参数，而不是 $$16*(6*5*5*1)=2400$$ 个参数。因为图像大小是10\*10，所以共有 $$1516*10*10=151600$$ 个连接而不是 $$2400*10*10=240000$$ 个。

## Source

{% embed url="https://engmrk.com/lenet-5-a-classic-cnn-architecture/" %}







