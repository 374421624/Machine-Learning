# AdaBoost

## AdaBoost算法

### 算法步骤

假设给定一个二分类的训练数据集 $$T = \{(x_1,y_1),(x_2,y_2),\dots,(x_N,y_N)\}$$ 其中，每个样本点由实例与标记组成。实例 $$x_i\in\mathcal{X}\subseteq R^n$$ ，标记 $$y_i \in \mathcal{Y}=\{-1,+1\}$$ ， $$\mathcal{X}$$ 是实例空间， $$\mathcal{Y}$$ 是标记集合。AdaBoost利用以下算法，从训练数据中学习一系列弱分类器或基本分类器，并将这些若分类器线性组合成为一个强分类器。

输入：训练数据集 $$T = \{(x_1,y_1),(x_2,y_2),\dots,(x_N,y_N)\}$$，其中 $$x_i\in\mathcal{X}\subseteq R^n$$ ，标记 $$y_i \in \mathcal{Y}=\{-1,+1\}$$ ，弱学习算法；

输出：最终分类器 $$G(x)$$ 

（1）初始化训练数据的权值分布

                        $$D_1=(w_{11},\dots,w_{1i},\dots,w_{1N}),\ \ \ w_{1i}=\frac{1}{N}, \ \ \ i=1,2,\dots,N$$ 

（2）对 $$m = 1,2,\dots,M$$ 

* （a）使用具有权值分布 $$D_m$$ 的训练数据集学习，得到基本分类器
*                         $$G_m(x):\mathcal{X}\to\{-1,+1\}$$ 
* （b）计算 $$G_m(x)$$ 在训练数据上的分类误差率
*                         $$e_m=\sum\limits_{i=1}^NP(G_m(x_i)\neq y_i)=\sum\limits_{i=1}^Nw_{mi}I(G_m(x_i)\neq y_i)$$ 
* （c）计算 $$G_m(x)$$ 的系数
*                          $$\alpha_m=\frac{1}{2}\ln\frac{1-e_m}{e_m}$$ 
* （d）更新训练数据集的权值分布
*                         $$D_{m+1}=(w_{m+1,1},\dots,w_{m+1,i},\dots,w_{m+1,N})$$ 
*                         $$w_{m+1,i}=\frac{w_{mi}}{Z_m}\exp(-\alpha_my_iG_m(x_i)),\ \ \ i=1,2,\dots,N$$ 
*                         $$Z_m=\sum\limits_{i=1}^Nw_{mi}\exp(-\alpha_my_iG_m(x_i))$$ 

（3）构建基本分类器的线性组合

                           $$f(x)=\sum\limits_{m=1}^M\alpha_mG_m(x)$$ 

           得到最终分类器

                            $$G(x)=sign(f(x))=sign(\sum\limits_{m=1}^M\alpha_mG_m(x))$$ 

### 步骤说明

步骤（1）：假设训练数据集具有均匀的权值分布，即每个训练样本在基本分类器的学习中作用相同，这一假设保证第1步能够在原始数据上学习基本分类器 $$G_1(x)$$ 

步骤（2）：AdaBoost反复学习基本分类器，在每一轮 $$m=1,2,\dots,M$$ 顺次地执行下列操作

* （a）使用当前分布 $$D_m$$ 加权的训练数据集，学习基本分类器 $$G_m(x)$$ 
* （b）计算基本分类器 $$G_m(x)$$ 在加权训练数据集上的分类误差率：
*                   $$e_m=\sum\limits_{i=1}^NP(G_m(x_i)\neq y_i)=\sum\limits_{G_m(x_i)\neq y_i}w_{mi}$$ 
*            这里， $$w_{mi}$$ 表示第 $$m$$ 轮中第 $$i$$ 个实例的权值， $$\sum\limits_{i=1}^Nw_{mi}=1$$ 。这表明， $$G_m(x)$$ 在加权的
*            训练数据集上的分类误差率是被 $$G_m(x)$$ 误分类样本的权值之和，由此可以看出数据权值分布
*            $$D_m$$ 与基本分类器 $$G_m(x)$$ 的分类误差率的关系。
* （c）计算基本分类器 $$G_m(x)$$ 的系数 $$\alpha_m$$。 $$\alpha_m$$ 表示 $$G_m(x)$$ 在最终分类器中的重要性。由
*            $$\alpha_m=\frac{1}{2}\ln\frac{1-e_m}{e_m}$$ 可知，当 $$e_m\leq\frac{1}{2}$$ 时， $$\alpha_m\geq0$$ ，并且 $$\alpha_m$$ 随着 $$e_m$$ 的减小而增大，所以
*             分类误差率越小的基本分类器在最终分类器中的作用越大。
* （d）更新训练数据的权值分布为下一轮作准备。
*            $$w_{m+1,i}=\frac{w_{mi}}{Z_m}\exp(-\alpha_my_iG_m(x_i)),\ \ \ i=1,2,\dots,N$$ 可写为
*            $$w_{m+1,i} = \begin{cases}\frac{w_{mi}}{Z_m}e^{-\alpha_m},\ \ \ G_m(x_i)=y_i\\ \frac{w_{mi}}{Z_m}e^{a_m},\ \ \ \ \ G_m(x_i)\neq y_i\end{cases}$$ 
*             由此可知，被基本分类器 $$G_m(x)$$ 误分类样本的权值得以扩大，而被正确分类的样本的权值却
*             得以缩小。两相比较，由$$\alpha_m=\frac{1}{2}\ln\frac{1-e_m}{e_m}$$ 知误分类样本的权值被放大 $$e^{2\alpha_m}=\frac{1-e_m}{e_m}$$ 被。因
*             此，误分类样本在下一轮学习中起更大的作用。不改变所给的训练数据，而不断改变训练数据
*             权值的分布，使得训练数据在基本分类器的学习中起不同的作用，这就是AdaBoost的一个特点

步骤（3）：线性组合 $$f(x)$$ 实现 $$M$$ 个基本分类器的加权表决。系数 $$\alpha_m$$ 表示了基本分类器 $$G_m(x)$$ 的重要性，这里，所有 $$\alpha_m$$ 之和并不为 $$1$$ 。 $$f(x)$$ 的符号决定实例 $$x$$ 的类， $$f(x)$$ 的绝对值表示分类的确信度。利用基本分类的线性组合构建最终分类器是AdaBoost的另一特点。

### 例子

| 序号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| x | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
| y | 1 | 1 | 1 | -1 | -1 | -1 | 1 | 1 | 1 | -1 |

步骤（1）：初始化数据权值分布

                        $$D_1=(w_{11},w_{12},\dots,w_{110}),\ \ \ w_{1i}=0.1,\ i=1,2,\dots,10$$ 

步骤（2）：

对 $$m = 1$$ ：

* （a）在权值分布为 $$D_1$$ 的训练数据上，阈值 $$v$$ 取 $$2.5$$ 时分类误差率最低，故基本分类器为
*            $$G_1(x)=\begin{cases}1,\ \ \ \ \ x<2.5\\-1,\ \ x>2.5\end{cases}$$ 
* （b） $$G_1(x)$$ 在训练数据集上的误差率 $$e_1=P(G_1(x_i)\neq y_i)=0.3$$ \(6,7,8样本错分，权值均为1\)
* （c）计算 $$G_1(x)$$ 的系数 $$\alpha_1 = \frac{1}{2}\log\frac{1-e_1}{e_1}=0.4236$$ 
* （d）更新训练数据的权值分布
*           $$D_2=(w_{21},w_{22},\dots,w_{210})$$ 
*           $$w_{2i} = \frac{w_{1i}}{Z_1}\exp(-\alpha_1y_iG_1(x_i)),\ \ \ i=1,2,\dots,10$$ 
*           $$D_2 = (0.07143,0.07143,0.07143,0.07143,0.07143,0.07143,0.16667,0.16667,0.16667,0.07143)$$           $$f_1(x)=0.4236G_1(x)$$ 
* 分类器 $$sign[f_1(x)]$$ 在训练数据集上有 $$3$$ 个误分类点。

对 $$m = 2$$ ：

*  （a）在权值分布为 $$D_2$$ 的训练数据上，阈值 $$v$$ 取 $$8.5$$ 时分类误差率最低，故基本分类器为
*            $$G_2(x)=\begin{cases}1,\ \ \ \ \ x<8.5\\-1,\ \ x>8.5\end{cases}$$ 
* （b） $$G_2(x)$$ 在训练数据集上的误差率 $$e_2=0.2143$$ \(4,5,6样本错分，权值均为0.07143\)
* （c）计算 $$G_2(x)$$ 的系数 $$\alpha_2 = \frac{1}{2}\log\frac{1-e_2}{e_2}=0.6496$$ 
* （d）更新训练数据的权值分布
*           $$D_3 = (0.0455,0.0455,0.0455,0.1667,0.1667,0.1667,0.1060,0.1060,0.1060,0.0455)$$     
*           $$f_2(x)=0.4236G_1(x)+0.6496G_2(x)$$ 
* 分类器 $$sign[f_2(x)]$$ 在训练数据集上有 $$3$$ 个误分类点。

对 $$m = 3$$ ：

*  （a）在权值分布为 $$D_3$$ 的训练数据上，阈值 $$v$$ 取 $$5.5$$ 时分类误差率最低，故基本分类器为
*            $$G_3(x)=\begin{cases}1,\ \ \ \ \ x<5.5\\-1,\ \ x>5.5\end{cases}$$ 
* （b） $$G_3(x)$$ 在训练数据集上的误差率 $$e_3=0.1820$$ \(4-9样本错分，权值见 $$D_3$$ \)
* （c）计算 $$G_3(x)$$ 的系数 $$\alpha_3 = \frac{1}{2}\log\frac{1-e_3}{e_3}=0.7514$$ 
* （d）更新训练数据的权值分布
*           $$D_4 = (0.125,0.125,0.125,0.102,0.102,0.102,0.065,0.065,0.065,0.125)$$     
*           $$f_3(x)=0.4236G_1(x)+0.6496G_2(x)+0.7514G_3(x)$$ 
* 分类器 $$sign[f_3(x)]$$ 在训练数据集上有 $$0$$ 个误分类点。

步骤（3）：于是最终分类器为

             $$G(x)=sign[f_3(x)]=sign[0.4236G_1(x)+0.6496G_2(x)+0.7514G_3(x)]$$ 

## AdaBoost训练误差分析

AdaBoost最基本的性质是它能在学习过程中不断减少训练误差，即在训练数据集上的分类学习误差率。关于这个问题有下面的定理：

_AdaBoost的训练误差界_：AdaBoost算法最终分类器的训练误差界为

                                 $$\frac{1}{N}\sum\limits_{i=1}^NI(G(x_i)\neq y_i)\leq\frac{1}{N}\sum\limits_{i}\exp(-y_if(x_i))=\prod\limits_mZ_m$$ 

其中，$$G(x)=sign(f(x))$$，$$f(x)=\sum\limits_{m=1}^M\alpha_mG_m(x)$$， $$Z_m=\sum\limits_{i=1}^Nw_{mi}\exp(-\alpha_my_iG_m(x_i))$$ 

#### 证明：

当



